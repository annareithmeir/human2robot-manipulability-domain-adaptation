#include <catch2.hpp>
#include <utils.h>

using namespace std;
using namespace Eigen;
#define CONFIG_CATCH_MAIN


TEST_CASE("compute_red_manipulability_3d", ""){
    MatrixXd J(8,7);
    Matrix result(36,7);
    J << -0.169153,    0.202907,   -0.302615,   -0.272979,   -0.309053,   -0.272979,   -0.169153,
            -0.272979,    0.22377,   -0.221061,   -0.169153,    -0.21446,   -0.169153,    0.272979,
            0.343647,   0.0855325  ,  0.234798 ,  -0.169635  ,  0.226257 ,  -0.169635 ,  -0.343647,
            -0.169635 ,  -0.389153,   -0.233293  ,  0.343647  , -0.239375 ,   0.343647 ,  -0.169635,
            0.132464 , -0.0268859  ,  0.122107 , -0.0365597  ,  0.122897  , -0.148939  ,  0.132382,
            -0.127105 ,   0.063706  ,  -0.15963  , 0.0159824 ,  -0.159114  , 0.0902094 ,   0.127055,
            -0.114691  ,  -0.11153 ,  -0.130204,  -0.0114358 ,  -0.129892  , -0.111446 ,    0.11464,
            -0.15989 ,-0.00189957   ,-0.138175  ,-0.0268195  , -0.138891  , -0.128921,   -0.159787;

    result=robot.ComputeManipulabilityJacobian(J);
    REQUIRE((result(0,0) - 0.0606596345260000) < 0.001);
}


